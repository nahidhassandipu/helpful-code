<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  
  <style>
  	.thumbnails {
    	border: 1px solid #ccc;
        border-radius: 4px;
        margin: 10px 0;
    } 
    .thumbnails .btn {
    	margin: 1.5%;
        width: 22%;
        font-size: 23px;
    }
  </style>
  
</head>
<body>

<center><h2>JavaScript Calculator</h2></center>

<div class='container'>
	<input type="text" class="form-control" id="usr" onpaste="event.preventDefault()" onkeypress='return keypressHandler(event)'>
    <div class='row thumbnails'>
    	<button type="button" id='CE' class="btn btn-primary">CE</button>    	
        <button type="button" id='C' class="btn btn-warning">C</button>
    	<button type="button" id='mod' class="btn btn-secondary arithmetic">%</button>
    	<button type="button" id='div' class="btn btn-secondary arithmetic">/</button>
    	<button type="button" class="btn btn-secondary num">7</button>
    	<button type="button" class="btn btn-secondary num">8</button>
    	<button type="button" class="btn btn-secondary num">9</button>
        <button type="button" id='star' class="btn btn-secondary arithmetic">*</button>
        <button type="button" class="btn btn-secondary num">4</button>
    	<button type="button" class="btn btn-secondary num">5</button>
    	<button type="button" class="btn btn-secondary num">6</button>
        <button type="button" id='minus' class="btn btn-secondary arithmetic">-</button>
        <button type="button" class="btn btn-secondary num">1</button>
    	<button type="button" class="btn btn-secondary num">2</button>
    	<button type="button" class="btn btn-secondary num">3</button>
        <button type="button" id='plus' class="btn btn-secondary arithmetic">+</button>
        <button type="button" id='dec' class="btn btn-secondary num">.</button>
    	<button type="button" class="btn btn-secondary num">0</button>    	
        <button type="button" class="btn btn-secondary num">00</button>
        <button type="button" id="eqaul" class="btn btn-secondary">=</button>        
    </div>
</div>

<p id="demo"></p>

<script>

  const _ = (el) => document.querySelectorAll(el);
  const __ = (sl) => document.querySelector(sl);
  let num = _('.num');
  let arithmetic = _('.arithmetic');
  let eqaul = __("#eqaul");
  let ce = __("#CE");
  let c = __("#C");
  
  function keypressHandler(event) {
    let charCode = event.which || event.keyCode;
    switch (charCode) {
    	case 45:
        	__("#minus").click();
            return false;
        case 43:
            __("#plus").click();
            return false;
        case 42:
            __("#star").click();
            return false;
        case 47:
            __("#div").click();
            return false;
        case 46:
            __("#dec").click();
            return false;
        case 37:
            __("#mod").click();
            return false;
        case 13:
            __("#eqaul").click();
            return true;
    }
    if (charCode == 37) {
      return true;
    }
    else if (charCode == 44) {
      return false;
    }
    else if (charCode > 31 && (charCode < 42 || charCode > 57)) {
      return false;
    }
  }

  __('#usr').addEventListener('focus', () => {
    if (__('#usr').value == "" ) {
      checkDisabled(true)
    } 
    if (__('#usr').value !== "" ){
      checkDisabled(false)
    }
  })
  
  __('#usr').addEventListener('input', (event) => {
    if (__('#usr').value !== "" ) {
      checkDisabled(false)
    }
    if (__('#usr').value == "" ) {
      checkDisabled(true)
    }
  })
  
  function checkDisabled(bool) {
    __("#star").disabled = bool;
    __("#plus").disabled = bool;
    __("#minus").disabled = bool;
    __("#div").disabled = bool;
    __("#mod").disabled = bool;	
  }

  num.forEach(function(item) {
    item.addEventListener('click', () => {
      checkDisabled(false)
      __('#usr').value += item.innerHTML;
    })	
  })
  arithmetic.forEach(function(item) {
    item.addEventListener('click', () => {
      __('#usr').value += item.innerHTML;
      checkDisabled(true)
      __("#dec").disabled = false;
    })	
  })
  __("#dec").addEventListener('click', () => {
    __("#dec").disabled = true;
  })
  eqaul.addEventListener('click', () => {
    let usrValue = __('#usr').value;
    checkDisabled(false)
    if(usrValue[usrValue.length - 1].match(/[^0-9]/g)) {
      __('#usr').value = eval(usrValue.slice(0, usrValue.length -1));
    } 
    else {
      __('#usr').value = eval(usrValue);	
    }
  })
  ce.addEventListener('click', () => { 
    __('#usr').value = "";
    if (__('#usr').value == "") {
      checkDisabled(true)
      __("#dec").disabled = false;
    }
  })	
  c.addEventListener('click', () => {
    let getVal = __('#usr').value;
    __('#usr').value = getVal.slice(0, getVal.length -1);
    if (__('#usr').value == "") {
      checkDisabled(true)
      __("#dec").disabled = false;
    }
  })
window.addEventListener('load', function() {
  checkDisabled(true)
}) 

</script> 

</body>
</html>
